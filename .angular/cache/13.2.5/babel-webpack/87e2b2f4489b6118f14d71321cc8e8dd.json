{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/services.service\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\n\nfunction CommunicationAddPage_ion_select_option_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const communication_type_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", communication_type_r3.communication_type_id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(communication_type_r3.name);\n  }\n}\n\nfunction CommunicationAddPage_ion_select_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const user_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", user_r4.user_id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", user_r4.first_name, \" \", user_r4.last_name, \"\");\n  }\n}\n\nfunction CommunicationAddPage_ion_select_option_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const department_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", department_r5.department_id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(department_r5.name);\n  }\n}\n\nexport let CommunicationAddPage = /*#__PURE__*/(() => {\n  class CommunicationAddPage {\n    constructor(servicio, loading, route) {\n      this.servicio = servicio;\n      this.loading = loading;\n      this.route = route;\n      this.id = 0;\n      this.type_id = 0;\n      this.recipient_id = 0;\n      this.department_id = 0;\n      this.anonymous = false;\n      this.message = '';\n      this.status = true;\n      this.communications_type = [];\n      this.communications_users = [];\n      this.communications_departments = [];\n      this.text = '';\n      this.id = this.route.snapshot.params.communication_id ? this.route.snapshot.params.communication_id : 0;\n    }\n\n    ngOnInit() {\n      this.sender_id = this.route.snapshot.paramMap.get('user_id');\n      console.log(this.sender_id);\n      this.load_type_of_communications();\n      this.load_users();\n      this.load_departments();\n    }\n\n    onChange(event) {\n      alert(\"Has seleccionado la id = \" + event.target.value);\n    }\n\n    load_type_of_communications() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let l = yield this.loading.create();\n        l.present();\n        this.servicio.communications_type_list(this.text).subscribe(data => {\n          this.communications_type = data.info.items;\n          console.log(this.communications_type);\n          l.dismiss();\n        }, error => {\n          l.dismiss();\n        });\n      });\n    }\n\n    load_users() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let l = yield this.loading.create();\n        l.present();\n        this.servicio.users_list(this.text).subscribe(data => {\n          this.communications_users = data.info.items;\n          console.log(this.communications_users);\n          l.dismiss();\n        }, error => {\n          l.dismiss();\n        });\n      });\n    }\n\n    load_departments() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let l = yield this.loading.create();\n        l.present();\n        this.servicio.departments_list(this.text).subscribe(data => {\n          this.communications_departments = data.info.items;\n          console.log(this.communications_departments);\n          l.dismiss();\n        }, error => {\n          l.dismiss();\n        });\n      });\n    }\n\n    save_communication() {\n      console.log(this.id);\n      console.log(this.type_id);\n      console.log(this.sender_id);\n      console.log(this.recipient_id);\n      console.log(this.department_id);\n      console.log(this.anonymous);\n      console.log(this.status);\n\n      if (this.type_id == 0) {\n        this.servicio.message('Debe ingresar un tipo de communicación', 'warning');\n      } else if (this.recipient_id == 0) {\n        this.servicio.message('Debe ingresar un empleado para dirigir su comunicación', 'warning');\n      } else if (this.department_id == 0) {\n        this.servicio.message('Debe ingresar un departamento', 'warning');\n      } else if (this.message == \"\") {\n        this.servicio.message('Debe ingresar un mensaje', 'warning');\n      } else {\n        this.servicio.communication_save({\n          communication_id: this.id,\n          communication_type_id: this.type_id,\n          communication_sender_id: this.sender_id,\n          communication_recipient_id: this.recipient_id,\n          communication_department_id: this.department_id,\n          anonymous: this.anonymous ? '1' : '0',\n          message: this.message,\n          status: this.status ? '1' : '0'\n        }).subscribe(data => {\n          //this.servicio.message('Comunicación enviada', 'success');\n          if (data.info.id > 0) {\n            this.servicio.goTo('/communications/' + this.sender_id);\n          }\n        }, _ => {\n          this.servicio.message('No se pudo enviar la comunicación', 'danger');\n        });\n      }\n    }\n\n  }\n\n  CommunicationAddPage.ɵfac = function CommunicationAddPage_Factory(t) {\n    return new (t || CommunicationAddPage)(i0.ɵɵdirectiveInject(i1.ServicesService), i0.ɵɵdirectiveInject(i2.LoadingController), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n  };\n\n  CommunicationAddPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CommunicationAddPage,\n    selectors: [[\"app-communication-add\"]],\n    decls: 34,\n    vars: 8,\n    consts: [[\"slot\", \"start\"], [\"defaultHref\", \"/communications\"], [\"lines\", \"full\", 1, \"type\"], [\"okText\", \"Aceptar\", \"cancelText\", \"Cancelar\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"lines\", \"full\", 1, \"employee\"], [\"lines\", \"full\", 1, \"department\"], [\"lines\", \"full\"], [\"color\", \"dark\", 3, \"ngModel\", \"ngModelChange\"], [\"position\", \"floating\"], [\"rows\", \"15\", 1, \"just-text\", 3, \"ngModel\", \"ngModelChange\"], [1, \"button\"], [\"expand\", \"full\", \"type\", \"submit\", \"color\", \"dark\", \"expand\", \"block\", 1, \"center-button\", 3, \"click\"], [3, \"value\"]],\n    template: function CommunicationAddPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n        i0.ɵɵelement(3, \"ion-back-button\", 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"Nueva Comunicaci\\u00F3n\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"ion-content\")(7, \"ion-list\")(8, \"ion-item\", 2)(9, \"ion-label\");\n        i0.ɵɵtext(10, \"Tipo de comunicaci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"ion-select\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function CommunicationAddPage_Template_ion_select_ngModelChange_11_listener($event) {\n          return ctx.type_id = $event;\n        });\n        i0.ɵɵtemplate(12, CommunicationAddPage_ion_select_option_12_Template, 2, 2, \"ion-select-option\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"ion-item\", 5)(14, \"ion-label\");\n        i0.ɵɵtext(15, \"Empleado\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"ion-select\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function CommunicationAddPage_Template_ion_select_ngModelChange_16_listener($event) {\n          return ctx.recipient_id = $event;\n        });\n        i0.ɵɵtemplate(17, CommunicationAddPage_ion_select_option_17_Template, 2, 3, \"ion-select-option\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"ion-item\", 6)(19, \"ion-label\");\n        i0.ɵɵtext(20, \"Departamento\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"ion-select\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function CommunicationAddPage_Template_ion_select_ngModelChange_21_listener($event) {\n          return ctx.department_id = $event;\n        });\n        i0.ɵɵtemplate(22, CommunicationAddPage_ion_select_option_22_Template, 2, 2, \"ion-select-option\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(23, \"ion-item\", 7)(24, \"ion-label\");\n        i0.ɵɵtext(25, \"Comunicaci\\u00F3n an\\u00F3nima\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"ion-toggle\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function CommunicationAddPage_Template_ion_toggle_ngModelChange_26_listener($event) {\n          return ctx.anonymous = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(27, \"ion-item\", 7)(28, \"ion-label\", 9);\n        i0.ɵɵtext(29, \"Mensaje\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"ion-textarea\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function CommunicationAddPage_Template_ion_textarea_ngModelChange_30_listener($event) {\n          return ctx.message = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(31, \"div\", 11)(32, \"ion-button\", 12);\n        i0.ɵɵlistener(\"click\", function CommunicationAddPage_Template_ion_button_click_32_listener() {\n          return ctx.save_communication();\n        });\n        i0.ɵɵtext(33, \"Enviar\");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngModel\", ctx.type_id);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.communications_type);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.recipient_id);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.communications_users);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.department_id);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.communications_departments);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.anonymous);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.message);\n      }\n    },\n    directives: [i2.IonHeader, i2.IonToolbar, i2.IonButtons, i2.IonBackButton, i2.IonBackButtonDelegate, i2.IonTitle, i2.IonContent, i2.IonList, i2.IonItem, i2.IonLabel, i2.IonSelect, i2.SelectValueAccessor, i4.NgControlStatus, i4.NgModel, i5.NgForOf, i2.IonSelectOption, i2.IonToggle, i2.BooleanValueAccessor, i2.IonTextarea, i2.TextValueAccessor, i2.IonButton],\n    styles: [\"ion-item[_ngcontent-%COMP%]{font-size:15px;background-color:red}.just-text[_ngcontent-%COMP%]{text-align:justify}.center-button[_ngcontent-%COMP%]{width:50%;margin:30px auto}\"]\n  });\n  return CommunicationAddPage;\n})();","map":null,"metadata":{},"sourceType":"module"}